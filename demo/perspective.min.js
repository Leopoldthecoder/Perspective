String.prototype.colorToRgb=function(){var c,d,a="rgb(",b=this.toLowerCase();if(4===b.length){for(c="#",d=1;4>d;d++)c+=b.slice(d,d+1).concat(b.slice(d,d+1));b=c}for(d=1;4>d;d++)a+=parseInt("0x"+b.slice(2*d-1,2*d+1)).toString(),3>d&&(a+=",");return a+=")"},perspective={},perspective.hover=function(a){var b,d,e;for(a=void 0===arguments[0]?!0:arguments[0],b=[],d=document.getElementsByTagName("div"),e=0;e<d.length;e++)"hover"===d[e].getAttribute("data-perspective")&&b.push(d[e]);for(e=0;e<b.length;e++)!function(c){function j(a){for(var b=0;h>b;b++)a(b)}function k(a,b,c){var e,d=["webkitTransform","msTransform","transform"];for(e=0;e<d.length;e++)a.style[d[e]]="translate("+b+"px,"+c+"px)"}function l(a,b,c,d){var e=Math.floor(d*(.5*document.body.clientWidth-b)),f=Math.floor(d*(.5*document.body.clientHeight-c));k(a,e,f)}var g,h,i,d=[],e=b[c],f=[];for(g=0;g<e.childNodes.length;g++)1==e.childNodes[g].nodeType&&(d.push(e.childNodes[g]),null!==e.childNodes[g].getAttribute("data-hover-speed")&&f.push(e.childNodes[g].getAttribute("data-hover-speed")));if(h=d.length,i=!1,f.length<h)for(g=f.length;h>g;g++)f.push(.2);e.onmousemove=function(a){i||j(function(b){l(d[b],a.clientX,a.clientY,f[b])})},e.onmouseout=function(b){if(a){var c=this.compareDocumentPosition(b.relatedTarget);20!=c&&0!=c&&(j(function(a){d[a].style.transition="0.1s"}),i||j(function(a){k(d[a],0,0)}))}},e.onmouseover=function(a){var b=this.compareDocumentPosition(a.relatedTarget);20!=b&&0!=b&&(i=!0,j(function(b){d[b].style.transition="0.1s",l(d[b],a.clientX,a.clientY,f[b])}),setTimeout(function(){i=!1,j(function(a){d[a].style.transition="0s"})},100))}}(e)},perspective.scroll=function(){function u(a){v(a,0),r=a?s[a-1]:a,w(r,!0)}function v(a,c){var g,e=b[a],f=document.getElementById("persp-controller").getElementsByTagName("li");for(d=!0,1===c&&a++,e.target.parentNode.style.transition="0.5s",e.target.parentNode.style.top="-"+100*a+"%",setTimeout(function(){d=!1},500),g=0;g<f.length;g++)!function(b){var c=f[b].getElementsByTagName("div")[0];b!==a?(c.style.backgroundColor="transparent",c.onmouseover=function(){c.style.backgroundColor="#999",c.parentNode.getElementsByTagName("span")[0].style.display="inline-block",c.parentNode.getElementsByTagName("span")[0].style.opacity="1"},c.onmouseout=function(){c.style.backgroundColor="transparent",c.parentNode.getElementsByTagName("span")[0].style.opacity="0",setTimeout(function(){c.parentNode.getElementsByTagName("span")[0].style.display="none"},200)},c.onclick=function(){u(b)}):(c.style.backgroundColor="#999",c.onmouseover=function(){return!1},c.onmouseout=function(){c.style.backgroundColor="#999",c.parentNode.getElementsByTagName("span")[0].style.opacity="0",setTimeout(function(){c.parentNode.getElementsByTagName("span")[0].style.display="none"},200)},c.onclick=function(){return!1})}(g)}function w(a,c){var h,i,e=0,f={},g=0;for(h=0;h<s.length;h++)a>=s[h]&&e++;for(f=b[e],h=0;e>h;h++)g+=b[h].sLength+1;if(!c&&!d||c){if(c)for(h=0;h<f.childCount;h++)f.layers[h].style.transition="0s";else d=!0,setTimeout(function(){d=!1},1e3*f.sDuration);for(h=0;h<f.childCount;h++)for(i=0;i<f.attr[h].length;i++)f.layers[h].style[f.attr[h][i]]=f.prop[h][i][a-g]}c&&setTimeout(function(){for(h=0;h<f.childCount;h++)f.layers[h].style.transition=f.sDuration+"s"},50)}function x(a){var b,c,e;if(!d){if(b=a.wheelDelta?a.wheelDelta:-a.detail,c=!1,0>b&&r===t||b>0&&0===r)return!1;for(0>b&&r++,b>0&&r--,e=0;e<s.length;e++){if(0>b&&r===s[e]){v(e,1),w(r,!0),c=!0;break}if(b>0&&r===s[e]-1){v(e,-1),w(r,!0),c=!0;break}}c||w(r,!1)}return!1}var f,g,h,i,j,k,l,n,o,p,q,r,s,t,y,z,A,B,a=document.getElementsByTagName("div"),b=[],c=/-?\d+(?:\.\d+)?/g,d=!1,e=/^#([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$/;for(f=0;f<a.length;f++)if("scroll"===a[f].getAttribute("data-perspective"))for(g=a[f],h=0;h<g.childNodes.length;h++)if(1==g.childNodes[h].nodeType)for(i=g.childNodes[h],j=[],k=0;k<i.childNodes.length;k++)1==i.childNodes[k].nodeType&&j.push(i.childNodes[k]);for(l=j.length,f=0;l>f;f++){for(b[f]={},b[f].target=j[f],b[f].target.style.transition="0.5s",b[f].sLength=parseInt(void 0===b[f].target.getAttribute("data-scroll-number")?1:b[f].target.getAttribute("data-scroll-number")),b[f].cssArr=arguments[f],h=0;h<b[f].cssArr.length;h++)for(n=b[f].cssArr[h].length,k=0;n>k;k++)e.test(b[f].cssArr[h][k].toString().replace(/\s+/g,""))&&(b[f].cssArr[h][k]=b[f].cssArr[h][k].toString().replace(/\s+/g,"").colorToRgb()),o=["transform","animation"],o.forEach(function(a){var c,d;if(b[f].cssArr[h][k].toString().toLowerCase()===a)for(c=["webkit","ms"],a=a.replace(/(\w)/,function(a){return a.toUpperCase()}),d=0;d<c.length;d++)b[f].cssArr[h].push(c[d]+a),b[f].cssArr[h].push(b[f].cssArr[h][k+1]),b[f].cssArr[h].push(b[f].cssArr[h][k+2])});for(b[f].layers=[],h=0;h<b[f].target.childNodes.length;h++)1==b[f].target.childNodes[h].nodeType&&b[f].layers.push(b[f].target.childNodes[h]);for(b[f].childCount=b[f].cssArr.length,b[f].layers=b[f].layers.slice(0,b[f].childCount),b[f].sDuration=arguments[l]?arguments[l][f]:.2,b[f].attr=[],b[f].prop=[],b[f].propNum=[],b[f].propStr=[],h=0;h<b[f].childCount;h++){for(b[f].layers[h].style.transition=b[f].sDuration+"s",b[f].attr[h]=[],b[f].prop[h]=[],b[f].propNum[h]=[],b[f].propStr[h]=[],k=0;k<b[f].cssArr[h].length;k++)switch(k%3){case 0:b[f].attr[h].push(b[f].cssArr[h][k]),b[f].propNum[h][k/3]=[],b[f].propStr[h][k/3]=[];break;case 1:b[f].propNum[h][Math.floor(k/3)][0]=b[f].cssArr[h][k].toString().match(c),b[f].propStr[h][Math.floor(k/3)]=b[f].cssArr[h][k].toString().split(c);break;case 2:b[f].propNum[h][Math.floor(k/3)][1]=b[f].cssArr[h][k].toString().match(c)}for(k=0;k<b[f].cssArr[h].length/3;k++){for(b[f].delta=[],m=0;m<b[f].propNum[h][k][0].length;m++)b[f].delta[m]=(b[f].propNum[h][k][1][m]-b[f].propNum[h][k][0][m])/b[f].sLength;for(b[f].prop[h][k]=[],p=0;p<=b[f].sLength;p++)if(0===p)b[f].prop[h][k][p]=b[f].cssArr[h][3*k+1];else{for(b[f].prop[h][k][p]="",q=0;q<b[f].propNum[h][k][0].length;q++)b[f].prop[h][k][p]+=p===b[f].sLength?b[f].propStr[h][k][q]+b[f].propNum[h][k][1][q]:b[f].propStr[h][k].join("").indexOf("rgb")>-1?b[f].propStr[h][k][q]+Math.floor(parseFloat(b[f].propNum[h][k][0][q])+b[f].delta[q]*p):b[f].propStr[h][k][q]+(parseFloat(b[f].propNum[h][k][0][q])+b[f].delta[q]*p);b[f].prop[h][k][p]+=b[f].propStr[h][k][q]}}}}for(r=0,s=[],t=0,f=0;f<b.length-1;f++)t+=b[f].sLength,s.push(t+f+1);for(t+=b[b.length-1].sLength+b.length-1,document.addEventListener&&document.addEventListener("DOMMouseScroll",x,!1),document.onmousewheel=x,y=document.createElement("ul"),y.setAttribute("id","persp-controller"),f=0;f<b.length;f++)z=document.createElement("li"),A=document.createElement("div"),B=document.createElement("span"),z.style.listStyle="none",z.style.display="block",z.style.position="relative",A.style.height="8px",A.style.width="8px",A.style.border="1px solid #fff",A.style.backgroundColor="transparent",A.style.boxShadow="0 0 1px 1px #999",A.style.borderRadius="50%",A.style.margin="16px 0",A.style.transition="0.2s",A.style.cursor="pointer",B.innerHTML=b[f].target.getAttribute("data-scroll-tag"),B.style.color="#777",B.style.font="12px arial",B.style.padding="2px 10px",B.style.backgroundColor="rgba(255,255,255,0.8)",B.style.borderRadius="4px",B.style.position="absolute",B.style.left="15px",B.style.top="-4px",B.style.transition="0.2s",B.style.opacity="0",z.appendChild(A),z.appendChild(B),y.appendChild(z);y.style.position="absolute",y.style.left="2%",y.style.top="50%",y.style.marginTop=-1*(13*b.length+8)+"px",y.style.zIndex=1e3,b[0].target.parentNode.parentNode.appendChild(y),v(0,0)};